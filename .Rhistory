}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
a <- c(3,5,7)
names(a) <- c('A','B','C')
length(dim(a))
rdirich(a)
a
rdirich(a)
rgamma(10,c(1,2))
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- randgamma / sum(randgamma)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2:rank_alpha,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
a <- c(3,5,7)
names(a) <- c('A','B','C')
length(dim(a))
rdirich(a)
rdirich(a)
rdirich(a)
rdirich(a)
a <- array(c(3,5,7,4,78,3),dim=c(3,2))
a
dimnames(a)[[1]] <- c('A','B','C')
a
dimnames(a)[[2]] <- c('Ins','Ebuq')
a
apply(alpha,1,function(x) rgamma(nrep,x))
apply(a,1,function(x) rgamma(5,x))
spply(a,function(x) rgamma(5,x))
sapply(a,function(x) rgamma(5,x))
apply(a,2,function(x) rgamma(5,x))
apply(a,c(1,2),function(x) rgamma(5,x))
b
apply(a,c(1,2),function(x) rgamma(5,x))
h <- apply(a,c(1,2),function(x) rgamma(5,x))
apply(h,2,sum)
apply(h,c(1,3),sum)
h/ apply(h,c(1,3),sum)
h / apply(h,c(1,3),sum)
h
apply(h,c(1,3),sum)
a
b
c
rdirich(c,5)
rdirich(c,nrep=5)
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- randgamma / sum(randgamma)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,2,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,1,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
print(randgamma)
rdir <- randgamma / apply(randgamma,1,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
a
apply(a,1,sum)
apply(h,1,sum)
h
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
print(randgamma)
print(apply(randgamma,2,sum))
rdir <- randgamma / apply(randgamma,2,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
print(randgamma)
print(apply(randgamma,2,sum))
rdir <- t(randgamma) / apply(randgamma,2,sum)
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
print(randgamma)
print(apply(randgamma,2,sum))
rdir <- t(t(randgamma) / apply(randgamma,2,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
?aperm
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- t(sapply(alpha, function(x) rgamma(nrep,x)))
print(randgamma)
print(apply(randgamma,2,sum))
rdir <- t(t(randgamma) / apply(randgamma,2,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
source('C:/Users/kaspe/source/repos/DKElections/DKElections/sampling.R', echo=TRUE)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,2,sum)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(h)
h
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(h)
rdirich(h,2)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
dim(randgamma) <- c(nrep, dim(alpha))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(h,2)
?redim
?dim
h
a
b
c
h
f
a
rdirich(a,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,5)
?apply
a
apply(a,1:2,function(x) rgamma(5,x))
dim(a)
length(dim(a))
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,1,sum))
rdir <- t(randgamma / apply(randgamma,1,sum))
print(rdir)
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
print(rank_alpha)
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,5)
apply(a,1:2,function(x) rgamma(nrep,x))
apply(a,1:2,function(x) rgamma(5,x))
rdirich(a,nrep=5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
print(rank_alpha)
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
print(randgamma)
print(apply(randgamma,c(1,3:(rank_alpha+1)),sum))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
print(rdir)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=5)
print(apply(a,1:2,function(x) rgamma(5,x)))
apply(a,1:2,function(x) rgamma(5,x))
x <- apply(a,1:2,function(x) rgamma(5,x))
x
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
print(rank_alpha)
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=5)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=5)
rdirich(a,nrep=1)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(rank_alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) as.vector(rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=1)
a
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1 || is.null(dim(alpha))) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) as.vector(rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=1)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (is.null(rank_alpha)) rank_alpha <- 1
if (rank_alpha == 1) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) as.vector(rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=1)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (is.na(rank_alpha)) rank_alpha <- 1
if (rank_alpha == 1) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) as.vector(rgamma(nrep,x)))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=1)
c
rdirich(c,nrep=1)
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (is.na(rank_alpha)) rank_alpha <- 1
if (rank_alpha == 1) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(c,nrep=1)
rdirich(a,nrep=1)
?coalesce
?is.null
dim(a)
dim(c)
c
rdirich <- function(alpha, nrep=1, seed=NULL) {
if (!is.null(seed)) set.seed(seed)
rank_alpha = length(dim(alpha))
if (rank_alpha == 1) {
randgamma <- sapply(alpha, function(x) rgamma(nrep,x))
rdir <- t(randgamma / apply(randgamma,1,sum))
} else {
randgamma <- apply(alpha,1:rank_alpha,function(x) rgamma(nrep,x))
rdir <- randgamma / apply(randgamma,c(1,3:(rank_alpha+1)),sum)
}
#  dimnames(rdir)[[1]] <- dimnames(alpha)[[1]]
rdir
}
rdirich(a,nrep=5)
rdirich(c,nrep=5)
